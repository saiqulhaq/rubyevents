<% grid_layout = defined?(grid_layout) && grid_layout %>
<% width_class = grid_layout ? "w-full" : "w-48 sm:w-64" %>

<%= link_to sponsor_path(sponsor), class: "#{width_class} flex relative bg-white rounded-xl border h-full hover:shadow-lg hover:border-gray-300 transition-all duration-200 transform hover:-translate-y-1", data: {turbo_frame: ((defined?(turbo_frame) && turbo_frame) ? "_top" : nil)} do %>
  <div class="card card-compact w-full pt-6">
    <figure class="flex justify-center px-4">
      <% image_size_class = grid_layout ? "w-24 h-24 sm:w-32 sm:h-32" : "w-32 h-32 sm:w-40 sm:h-40" %>

      <% if sponsor.has_logo_image? %>
        <div class="<%= sponsor.logo_background_class %> rounded-lg p-2 border border-gray-200">
          <%= image_tag(
                sponsor.logo_image_path,
                alt: "#{sponsor.name} logo",
                class: "#{image_size_class} object-contain",
                loading: "lazy",
                onerror: "this.style.display='none'; this.nextElementSibling.style.display='flex';"
              ) %>

          <div class="<%= image_size_class %> items-center justify-center" style="display: none;">
            <span class="text-lg font-semibold text-gray-700 text-center line-clamp-3"><%= sponsor.name %></span>
          </div>
        </div>
      <% else %>
        <div class="<%= image_size_class %> flex items-center justify-center">
          <span class="text-lg font-semibold text-gray-700 text-center line-clamp-3"><%= sponsor.name %></span>
        </div>
      <% end %>
    </figure>

    <div class="card-body items-center text-center pt-4 px-0 justify-center <%= "pb-6" if defined?(hide_event_count) && hide_event_count %>">
      <h3 class="<%= grid_layout ? "text-sm sm:text-base" : "text-xl" %> font-semibold text-slate-700 line-clamp-1"><%= sponsor.name %></h3>

      <% if defined?(event_sponsor) && event_sponsor&.badge.present? %>
        <div class="mt-2 mx-4 px-2 py-1 <%= grid_layout ? "text-xs" : "text-sm" %> bg-blue-600 text-white rounded-full font-medium truncate text-center max-w-full" title="<%= event_sponsor.badge %>">
          <%= event_sponsor.badge %>
        </div>
      <% end %>

      <% unless defined?(hide_event_count) && hide_event_count %>
        <div class="<%= grid_layout ? "text-xs sm:text-sm" : "text-base" %> text-slate-600"><%= pluralize(sponsor.events.count, "event") %></div>
      <% end %>
    </div>
  </div>
<% end %>
